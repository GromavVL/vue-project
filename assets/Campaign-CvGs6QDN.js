import{C as A}from"./auto-sRkgK8jz.js";import{P as I,c as S}from"./Msg-CiP7AL8w.js";import{T as x,H as F,l as L}from"./loader-B_YgijKb.js";import{I as E}from"./ImageUpload-DOOh1Ylc.js";import{_ as N,c as n,a as m,e as d,b as e,r as C,w as f,f as u,t as r,d as c,v,F as g,h as D,g as b,o,i as T}from"./index-x6f1RFcC.js";const q={name:"Campaign",components:{Header:F,Popup:I,Toogle:x,Image:E},inject:["appUrl","appUser","appLogout"],data(){return{formData:{},loaderGif:L,data:{items:[],info:{}},details:[],date:"",date2:"",q:"",sort:"",loader:1,iChart:-1,id:0,type:0,all:!0,chartInstance:null}},computed:{api(){return S(this.appUrl,this.appUser?this.appUser.auth:"")}},mounted(){if(this.appUser&&!this.appUser.auth){this.appLogout();return}this.get()},beforeUnmount(){this.chartInstance&&(this.chartInstance.destroy(),this.chartInstance=null)},methods:{get(){this.loader=1;const l=this.$route.params.id;if(!this.appUrl){this.loader=0;return}this.api.getBanners(this.formData,{date:this.date,date2:this.date2,id:l}).then(t=>{this.loader=0,this.data=t.data,this.data.info&&this.data.info.title&&(document.title=this.data.info.title),this.iChart!==-1&&this.data.items[this.iChart]&&this.line(this.data.items[this.iChart])}).catch(t=>{t.isApiError?console.error(t.message):(console.error(t),this.appLogout()),this.loader=0})},getDetails(l=!1,t=!1){this.details=[],l&&(this.id=l),t&&(this.type=t),this.id&&(l=this.id),this.type&&(t=this.type),this.loader=1,this.api.getStatisticsDetails(this.formData,{date:this.date,date2:this.date2,q:this.q,sort:this.sort,bid:l||"",type:t||""}).then(p=>{this.details=p.data,this.loader=0}).catch(p=>{p.isApiError?console.error(p.message):this.appLogout(),this.loader=0})},action(){this.formData&&this.api.actionCampaign(this.formData).then(l=>{this.$refs.new&&(this.$refs.new.active=0),this.formData.id?this.$refs.header.$refs.msg.successFun("Successfully updated campaign!"):this.$refs.header.$refs.msg.successFun("Successfully added new campaign!"),this.get()}).catch(l=>{l.isApiError?this.$refs.header.$refs.msg.alertFun(l.message):console.log("errors: ",l)})},actionAd(){if(!this.formData)return;this.formData.copy="";const l=this.$route.params.id;this.api.actionBanner(this.formData,l).then(t=>{this.$refs.ad&&(this.$refs.ad.active=0),this.formData.id?this.$refs.header.$refs.msg.successFun("Successfully updated banner!"):this.$refs.header.$refs.msg.successFun("Successfully added new banner!"),this.get()}).catch(t=>{t.isApiError?this.$refs.header.$refs.msg.alertFun(t.message):console.log("errors: ",t)})},async delAd(){await this.$refs.header.$refs.msg.confirmFun("Please confirm next action","Do you want to delete this banner?")&&this.api.deleteBanner(this.formData).then(l=>{this.$refs.header.$refs.msg.successFun("Successfully deleted banner!"),this.get()}).catch(l=>{l.isApiError?this.$refs.header.$refs.msg.alertFun(l.message):console.log("errors",l)})},line(l){this.$nextTick(()=>{if(!this.$refs.chartOuter)return;const t=[],p=[],w=[];if(l&&l.line)for(const a in l.line)t.push(a),p.push(l.line[a].clicks||0),w.push(l.line[a].views||0);const s=this.$refs.myChart;s&&(this.chartInstance&&this.chartInstance.destroy(),this.chartInstance=new A(s,{type:"line",data:{labels:t,datasets:[{label:"Clicks",backgroundColor:"#005990",borderColor:"#00599D",data:p,tension:.1},{label:"Views",backgroundColor:"#5000B8",borderColor:"#5000B8",data:w,yAxisID:"y2",tension:.1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{position:"left",beginAtZero:!0},y2:{position:"right",beginAtZero:!0,grid:{drawOnChartArea:!1}},x:{ticks:{maxRotation:45,minRotation:45}}}}}))})},checkAll(l){if(!this.data.items[this.iChart])return;const t=this.data.items[this.iChart].sites;t&&Object.values(t).forEach(p=>{p.include=l}),this.formData=this.data.items[this.iChart],this.get()}}},B={class:"page-wrapper"},H={key:0,id:"spinner"},P=["src"],O={class:"sub-header"},R={class:"content-container flex-between"},M={key:0,class:"campaign-title"},j={class:"content-container"},z={class:"toolbar"},G={class:"toolbar-left"},Z={class:"toolbar-center"},K={class:"date-group"},J={key:0,class:"table-card"},Q={class:"styled-table"},W={class:"td-actions"},X=["onClick"],Y=["onClick"],$=["onClick"],tt=["onClick"],et=["onClick"],st=["onClick"],it=["onClick"],lt={class:"td-link"},nt=["href"],ot={class:"td-toggle"},at={class:"toggle-wrapper"},rt=["onClick"],dt=["src"],ut={class:"row-id"},ft={key:1,class:"empty-state"},ht={class:"flex panel"},pt={class:"w30 ptb25"},ct={class:"w70 al"},mt={class:"flex cubes"},vt={class:"w30 clicks"},gt={class:"w30 views"},kt={class:"w30 leads"},yt={class:"w30 ctr"},Ct={class:"flex body"},Dt={class:"w30 ar filchart"},bt={class:"itemchart ptble"},wt={class:"w70",ref:"chartOuter"},_t={ref:"chartHints"},Vt={ref:"myChart"},Ut={class:"form inner-form"},At={class:"row"},It={class:"row"},St={key:0,class:"btnS"},xt={key:1,class:"btnS"},Ft={class:"form inner-form"},Lt={class:"row"},Et={class:"row"},Nt={class:"row"},Tt=["value"],qt={class:"row"},Bt={class:"row"},Ht={key:0,class:"btnS"},Pt={key:1,class:"btnS"},Ot={class:"flex panel"},Rt={class:"w60"},Mt={class:"table"},jt={key:0},zt={class:"id"},Gt={key:1,class:"empty"};function Zt(l,t,p,w,s,a){const V=C("Header"),_=C("Toogle"),y=C("Popup"),U=C("Image");return o(),n("div",B,[m(V,{ref:"header"},null,512),s.loader?(o(),n("div",H,[e("img",{src:s.loaderGif,alt:"Loading..."},null,8,P)])):d("",!0),e("div",O,[e("div",R,[e("a",{class:"btn-edit",href:"#",onClick:t[0]||(t[0]=f(i=>{s.formData=s.data.info,l.$refs.new.active=1},["prevent"]))},[...t[23]||(t[23]=[u(" Edit campaign ",-1),e("i",{class:"fas fa-edit"},null,-1)])]),s.data&&s.data.info?(o(),n("h1",M,r(s.data.info.title),1)):d("",!0)])]),e("div",j,[e("div",z,[e("div",G,[e("a",{class:"btn-new",href:"#",onClick:t[1]||(t[1]=f(i=>{s.formData={},l.$refs.ad.active=1},["prevent"]))},[...t[24]||(t[24]=[u(" New ",-1),e("i",{class:"fas fa-plus"},null,-1)])])]),e("div",Z,[e("div",K,[c(e("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=i=>s.date=i),onChange:t[3]||(t[3]=i=>a.get())},null,544),[[v,s.date]]),t[25]||(t[25]=e("span",{class:"sep"},"-",-1)),c(e("input",{type:"date","onUpdate:modelValue":t[4]||(t[4]=i=>s.date2=i),onChange:t[5]||(t[5]=i=>a.get())},null,544),[[v,s.date2]])])]),t[26]||(t[26]=e("div",{class:"toolbar-right"},[e("span",{class:"section-label"},"Ads")],-1))]),s.data.items&&s.data.items.length>0?(o(),n("div",J,[e("table",Q,[t[30]||(t[30]=e("thead",null,[e("tr",null,[e("th",{class:"th-actions"},"Actions"),e("th",null,"Fraud clicks"),e("th",null,"Leads"),e("th",null,"Clicks"),e("th",null,"Views"),e("th",{class:"th-link"},"Link"),e("th",null,"Size"),e("th",null,"Img")])],-1)),e("tbody",null,[(o(!0),n(g,null,D(s.data.items,(i,k)=>(o(),n("tr",{key:i.id||k},[e("td",W,[e("a",{href:"#",class:"action-icon del",onClick:f(h=>{s.formData=i,a.delAd()},["prevent"])},[...t[27]||(t[27]=[e("i",{class:"fas fa-trash-alt"},null,-1)])],8,X),e("a",{href:"#",class:"action-icon chart",onClick:f(h=>{s.formData=i,s.iChart=k,l.$refs.chart.active=1,a.line(i)},["prevent"])},[...t[28]||(t[28]=[e("i",{class:"fas fa-chart-bar"},null,-1)])],8,Y),e("a",{href:"#",class:"action-icon edit",onClick:f(h=>{s.formData=i,l.$refs.ad.active=1},["prevent"])},[...t[29]||(t[29]=[e("i",{class:"fas fa-edit"},null,-1)])],8,$)]),e("td",null,[e("a",{href:"#",onClick:f(h=>{l.$refs.details.active=1,a.getDetails(i.id,4)},["prevent"])},r(i.fclicks||0),9,tt)]),e("td",null,[e("a",{href:"#",onClick:f(h=>{l.$refs.details.active=1,a.getDetails(i.id,3)},["prevent"])},r(i.leads||0),9,et)]),e("td",null,[e("a",{href:"#",onClick:f(h=>{l.$refs.details.active=1,a.getDetails(i.id,2)},["prevent"])},[i.clicks?(o(),n(g,{key:0},[u(r(i.clicks),1)],64)):(o(),n(g,{key:1},[u("0")],64))],8,st)]),e("td",null,[e("a",{href:"#",onClick:f(h=>{l.$refs.details.active=1,a.getDetails(i.id,1)},["prevent"])},r(i.views),9,it)]),e("td",lt,[e("a",{href:i.link,target:"_blank",class:"link-text"},r(i.link),9,nt)]),e("td",null,r(i.size),1),e("td",ot,[e("div",at,[i.img?(o(),n("div",{key:0,class:"mini-preview",onClick:f(h=>{s.formData=i,l.$refs.ad.active=1},["prevent"])},[e("img",{src:a.appUrl+"/"+i.img},null,8,dt)],8,rt)):d("",!0),m(_,{modelValue:i.published,"onUpdate:modelValue":h=>{i.published=h,s.formData=i,a.actionAd()}},null,8,["modelValue","onUpdate:modelValue"]),e("span",ut,r(i.id),1)])])]))),128))])])])):s.loader?d("",!0):(o(),n("div",ft,"No items found"))]),m(y,{ref:"chart",fullscreen:"true",title:"Chart"},{default:b(()=>[e("div",ht,[e("div",pt,[c(e("input",{class:"legacy-input",type:"date","onUpdate:modelValue":t[6]||(t[6]=i=>s.date=i),onChange:t[7]||(t[7]=i=>a.get())},null,544),[[v,s.date]]),c(e("input",{class:"legacy-input",type:"date","onUpdate:modelValue":t[8]||(t[8]=i=>s.date2=i),onChange:t[9]||(t[9]=i=>a.get())},null,544),[[v,s.date2]])]),e("div",ct,[e("div",mt,[e("div",vt,[t[31]||(t[31]=e("div",null,"Clicks",-1)),u(" "+r(s.data.items&&s.data.items[s.iChart]?s.data.items[s.iChart].clicks:0),1)]),e("div",gt,[t[32]||(t[32]=e("div",null,"Views",-1)),u(" "+r(s.data.items&&s.data.items[s.iChart]?s.data.items[s.iChart].views:0),1)]),e("div",kt,[t[33]||(t[33]=e("div",null,"Leads",-1)),u(" "+r(s.data.items&&s.data.items[s.iChart]?s.data.items[s.iChart].leads:0),1)]),e("div",yt,[t[34]||(t[34]=e("div",null,"CTR",-1)),u(" "+r(s.data.items&&s.data.items[s.iChart]&&s.data.items[s.iChart].views>0?(s.data.items[s.iChart].clicks*100/s.data.items[s.iChart].views).toFixed(2):"0.00"),1)])])])]),e("div",Ct,[e("div",Dt,[e("div",bt,[m(_,{modelValue:s.all,"onUpdate:modelValue":t[10]||(t[10]=i=>{s.all=i,a.checkAll(i)})},null,8,["modelValue"]),t[35]||(t[35]=u(" ALL ",-1)),t[36]||(t[36]=e("hr",null,null,-1)),s.data.items&&s.data.items[s.iChart]&&s.data.items[s.iChart].sites?(o(!0),n(g,{key:0},D(s.data.items[s.iChart].sites,(i,k)=>(o(),n("div",{class:"itemchart ptble",key:k},[m(_,{modelValue:i.include,"onUpdate:modelValue":h=>{i.include=h,s.formData=s.data.items[s.iChart],a.get()}},null,8,["modelValue","onUpdate:modelValue"]),u(" "+r(i.site),1)]))),128)):d("",!0)])]),e("div",wt,[e("div",_t,[...t[37]||(t[37]=[e("div",{class:"chartHintsViews"},"Views",-1),e("div",{class:"chartHintsClicks"},"Clicks",-1)])],512),e("canvas",Vt,null,512),t[38]||(t[38]=e("hr",null,null,-1))],512)])]),_:1},512),m(y,{ref:"new",title:s.formData&&s.formData.id?"Edit campaign":"New campaign"},{default:b(()=>[e("div",Ut,[s.formData?(o(),n("form",{key:0,onSubmit:t[12]||(t[12]=f(i=>a.action(),["prevent"]))},[e("div",At,[t[39]||(t[39]=e("label",null,"Name",-1)),c(e("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=i=>s.formData.title=i),required:""},null,512),[[v,s.formData.title]])]),e("div",It,[s.formData&&s.formData.id?(o(),n("button",St," Edit ")):d("",!0),s.formData&&!s.formData.id?(o(),n("button",xt," Add ")):d("",!0)])],32)):d("",!0)])]),_:1},8,["title"]),m(y,{ref:"ad",title:s.formData&&s.formData.id?"Edit banner":"New banner"},{default:b(()=>[e("div",Ft,[s.formData?(o(),n("form",{key:0,onSubmit:t[18]||(t[18]=f(i=>a.actionAd(),["prevent"]))},[e("div",Lt,[t[40]||(t[40]=e("label",null,"Link",-1)),c(e("input",{type:"text","onUpdate:modelValue":t[13]||(t[13]=i=>s.formData.link=i),required:""},null,512),[[v,s.formData.link]])]),e("div",Et,[t[41]||(t[41]=e("label",null,"Description",-1)),c(e("input",{type:"text","onUpdate:modelValue":t[14]||(t[14]=i=>s.formData.description=i)},null,512),[[v,s.formData.description]])]),e("div",Nt,[t[43]||(t[43]=e("label",null,"Type",-1)),c(e("select",{"onUpdate:modelValue":t[15]||(t[15]=i=>s.formData.type=i),required:""},[t[42]||(t[42]=e("option",{value:"0"},null,-1)),s.data.types?(o(!0),n(g,{key:0},D(s.data.types,i=>(o(),n("option",{value:i.id,key:i.id},r(i.title),9,Tt))),128)):d("",!0)],512),[[T,s.formData.type]])]),e("div",qt,[t[44]||(t[44]=e("label",null,"Image",-1)),m(U,{modelValue:s.formData.img,"onUpdate:modelValue":[t[16]||(t[16]=i=>s.formData.img=i),t[17]||(t[17]=i=>s.formData.img=i)]},null,8,["modelValue"])]),e("div",Bt,[s.formData&&s.formData.id?(o(),n("button",Ht," Edit ")):d("",!0),s.formData&&!s.formData.id?(o(),n("button",Pt," Add ")):d("",!0)])],32)):d("",!0)])]),_:1},8,["title"]),m(y,{ref:"details",fullscreen:"true",title:"Details"},{default:b(()=>[e("div",Ot,[e("div",Rt,[c(e("input",{type:"text",placeholder:"Search...","onUpdate:modelValue":t[19]||(t[19]=i=>s.q=i),onKeyup:t[20]||(t[20]=i=>a.getDetails())},null,544),[[v,s.q]]),c(e("input",{class:"legacy-input",type:"date","onUpdate:modelValue":t[21]||(t[21]=i=>s.date=i),onChange:t[22]||(t[22]=i=>a.getDetails())},null,544),[[v,s.date]])]),t[45]||(t[45]=e("div",{class:"w40 al"},null,-1))]),t[47]||(t[47]=e("br",null,null,-1)),e("div",Mt,[s.details&&s.details.length>0?(o(),n("table",jt,[t[46]||(t[46]=e("thead",null,[e("tr",null,[e("th",{class:"id"},"#"),e("th",null,"Type"),e("th",null,[u("IP "),e("i",{class:"fas fa-caret-down"})]),e("th",{class:"id"},"Date"),e("th",{class:"id"},"Site")])],-1)),e("tbody",null,[(o(!0),n(g,null,D(s.details,(i,k)=>(o(),n("tr",{key:i.id||k},[e("td",zt,r(i.id),1),e("td",null,[i.type===1?(o(),n(g,{key:0},[u("Views")],64)):d("",!0),i.type===2?(o(),n(g,{key:1},[u("Clicks")],64)):d("",!0),i.type===3?(o(),n(g,{key:2},[u("Leads")],64)):d("",!0)]),e("td",null,r(i.ip),1),e("td",null,r(i.date),1),e("td",null,r(i.site),1)]))),128))])])):(o(),n("div",Gt,"No items"))])]),_:1},512)])}const Yt=N(q,[["render",Zt],["__scopeId","data-v-0e3d512f"]]);export{Yt as default};
