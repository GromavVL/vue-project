import{P as k,c as w}from"./Msg-CiP7AL8w.js";import{T as V,H as x,l as C}from"./loader-B_YgijKb.js";import{_ as E,c as l,a as u,e as n,b as e,r as p,w as f,f as g,d as c,v as h,g as _,F as N,h as F,o as a,t as m}from"./index-x6f1RFcC.js";const P={name:"Users",components:{Header:x,Popup:k,Toogle:V},inject:["appUrl","appUser","appLogout"],data(){return{formData:{},loaderGif:C,data:{items:[]},q:"",sort:"",loader:1}},computed:{api(){return w(this.appUrl,this.appUser?this.appUser.auth:"")}},mounted(){if(this.appUser&&!this.appUser.auth){this.appLogout();return}this.get()},methods:{get(){if(this.loader=1,!this.appUrl){console.log("URL API not found"),this.loader=0;return}this.api.getUsers({q:this.q,sort:this.sort}).then(r=>{this.data=r.data,this.loader=0}).catch(r=>{r.isApiError?console.error(r.message):(console.error(r),this.appLogout()),this.loader=0})},action(){this.formData&&this.api.actionUser(this.formData).then(r=>{this.$refs.new&&(this.$refs.new.active=0),this.$refs.header&&this.$refs.header.$refs.msg&&(this.formData.id?this.$refs.header.$refs.msg.successFun("Successfully updated user!"):this.$refs.header.$refs.msg.successFun("Successfully added new user!")),this.get()}).catch(r=>{r.isApiError&&this.$refs.header&&this.$refs.header.$refs.msg?this.$refs.header.$refs.msg.alertFun(r.message):console.log("errors",r)})},async del(r){this.formData=r,this.$refs.header&&this.$refs.header.$refs.msg&&await this.$refs.header.$refs.msg.confirmFun("Please confirm next action","Do you want to delete this user?")&&this.api.deleteUser(this.formData).then(s=>{this.$refs.header.$refs.msg.successFun("Successfully deleted user!"),this.get()}).catch(s=>{s.isApiError?this.$refs.header.$refs.msg.alertFun(s.message):console.log("errors",s)})}}},S={class:"page-container"},q={key:0,id:"spinner"},A=["src"],L={class:"content-wrapper"},T={class:"toolbar"},H={class:"toolbar-left"},$={class:"toolbar-center"},B={class:"form-container"},G={class:"form-group"},I={class:"form-group"},M={class:"form-group"},j={class:"form-actions"},K={key:0,class:"btn-primary"},R={key:1,class:"btn-primary"},z={key:0,class:"table-container"},J={class:"data-table"},O={class:"col-id"},Q={class:"col-toggle"},W={class:"col-name"},X={class:"col-actions"},Y=["onClick"],Z=["onClick"],ee={key:1,class:"empty-state"};function se(r,s,te,oe,t,i){const v=p("Header"),D=p("Popup"),y=p("Toogle"),U=p("router-link");return a(),l("div",S,[u(v,{ref:"header"},null,512),t.loader?(a(),l("div",q,[e("img",{src:t.loaderGif,alt:"Loading..."},null,8,A)])):n("",!0),e("div",L,[e("div",T,[e("div",H,[e("a",{class:"btn-primary",href:"#",onClick:s[0]||(s[0]=f(o=>{t.formData={},r.$refs.new.active=1},["prevent"]))},[...s[7]||(s[7]=[e("i",{class:"fas fa-plus"},null,-1),g(" New ",-1)])])]),e("div",$,[c(e("input",{type:"text",placeholder:"Search...","onUpdate:modelValue":s[1]||(s[1]=o=>t.q=o),onKeyup:s[2]||(s[2]=o=>i.get()),class:"search-input"},null,544),[[h,t.q]])]),s[8]||(s[8]=e("div",{class:"toolbar-right"},[e("h1",{class:"page-title"},"Users")],-1))]),u(D,{ref:"new",title:t.formData&&t.formData.id?"Edit user":"New user"},{default:_(()=>[e("div",B,[t.formData?(a(),l("form",{key:0,onSubmit:s[6]||(s[6]=f(o=>i.action(),["prevent"]))},[e("div",G,[s[9]||(s[9]=e("label",null,"Name",-1)),c(e("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=o=>t.formData.name=o),required:"",placeholder:"Enter name...",class:"text-input"},null,512),[[h,t.formData.name]])]),e("div",I,[s[10]||(s[10]=e("label",null,"Email",-1)),c(e("input",{type:"email","onUpdate:modelValue":s[4]||(s[4]=o=>t.formData.email=o),required:"",placeholder:"Enter email...",class:"text-input"},null,512),[[h,t.formData.email]])]),e("div",M,[s[11]||(s[11]=e("label",null,"Phone",-1)),c(e("input",{type:"text","onUpdate:modelValue":s[5]||(s[5]=o=>t.formData.phone=o),placeholder:"Enter phone...",class:"text-input"},null,512),[[h,t.formData.phone]])]),e("div",j,[t.formData&&t.formData.id?(a(),l("button",K," Save Changes ")):n("",!0),t.formData&&!t.formData.id?(a(),l("button",R," Add User ")):n("",!0)])],32)):n("",!0)])]),_:1},8,["title"]),t.data.items&&t.data.items.length>0?(a(),l("div",z,[e("table",J,[s[14]||(s[14]=e("thead",null,[e("tr",null,[e("th",{class:"col-id"},"#"),e("th",{class:"col-toggle"},"Status"),e("th",null,"Name"),e("th",null,"Email"),e("th",null,"Phone"),e("th",{class:"col-actions"},"Actions")])],-1)),e("tbody",null,[(a(!0),l(N,null,F(t.data.items,(o,b)=>(a(),l("tr",{key:o.id||b},[e("td",O,m(o.id),1),e("td",Q,[u(y,{modelValue:o.published,"onUpdate:modelValue":[d=>o.published=d,d=>{t.formData=o,i.action()}]},null,8,["modelValue","onUpdate:modelValue"])]),e("td",W,[u(U,{to:"/user/"+o.id,class:"link-primary"},{default:_(()=>[g(m(o.name),1)]),_:2},1032,["to"])]),e("td",null,m(o.email),1),e("td",null,m(o.phone),1),e("td",X,[e("a",{href:"#",onClick:f(d=>{t.formData=o,r.$refs.new.active=1},["prevent"])},[...s[12]||(s[12]=[e("i",{class:"fas fa-edit"},null,-1)])],8,Y),e("a",{href:"#",onClick:f(d=>{t.formData=o,i.del(o)},["prevent"]),class:"icon-delete"},[...s[13]||(s[13]=[e("i",{class:"fas fa-trash-alt"},null,-1)])],8,Z)])]))),128))])])])):n("",!0),!t.loader&&(!t.data.items||t.data.items.length===0)?(a(),l("div",ee," No items found ")):n("",!0)])])}const ne=E(P,[["render",se],["__scopeId","data-v-8669ab3c"]]);export{ne as default};
